import{a as K,e as X,b as ue,c as we,s as ke,d as je}from"../chunks/D9ilNyEn.js";import"../chunks/DsnmJJEf.js";import{d as ae,s as j,e as Ee,o as Se}from"../chunks/D9Q0S_Q0.js";import{p as oe,W as pe,G as a,c as se,f as Q,e as E,k as ne,X as S,i as H,l as t,r,j as n,o as e,Y as Me,t as V,m as ve,F as Pe}from"../chunks/DjbzThlV.js";import{p as re,i as F}from"../chunks/BPjjjB19.js";import{r as Ce,s as Oe}from"../chunks/CkDF1lTp.js";class I extends Error{details;constructor(o,l){super(o),this.details=l}}const De=(async({fetch:O})=>{try{const o=await O(K("/projects"));if(!o.ok)throw o.status===404?X(404,new I("Projects endpoint not found","The server could not find the projects resource")):o.status===401||o.status===403?X(403):o.status===500?X(500,new I("Server error","The server encountered an error while fetching projects")):X(o.status,new I("Failed to fetch projects",`Server returned status ${o.status}: ${o.statusText}`));return{projects:await o.json()}}catch(o){throw o&&typeof o=="object"&&"status"in o?o:(console.error("Error loading projects:",o),X(503,new I("Failed to connect to server","Please check your network connection and try again")))}}),Ie=Object.freeze(Object.defineProperty({__proto__:null,load:De},Symbol.toStringTag,{value:"Module"}));var Te=H('<div class="mb-4 rounded-lg bg-red-50 p-3 text-sm text-red-800"> </div>'),ze=H('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4" tabindex="0" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full max-w-md rounded-lg bg-white shadow-xl"><div class="border-b border-gray-200 px-6 py-4"><h3 id="modal-title" class="text-xl font-bold text-gray-900"> </h3></div> <form class="p-6"><!> <div class="mb-4"><label for="name" class="mb-1 block text-sm font-medium text-gray-700">Project Name <span class="text-red-500">*</span></label> <input type="text" id="name" class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none" placeholder="Enter project name" required/></div> <div class="mb-6"><label for="description" class="mb-1 block text-sm font-medium text-gray-700">Description</label> <textarea id="description" rows="3" class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none" placeholder="Enter project description (optional)"></textarea></div> <div class="flex justify-end gap-3"><button type="button" class="rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button> <button type="submit" class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:bg-blue-400"> </button></div></form></div></div>');function Be(O,o){oe(o,!0);let l=re(o,"isOpen",15,!1),i=re(o,"project",3,null),d=S(""),m=S(""),u=S(!1),b=S("");pe(()=>{l()&&(i()?(a(d,i().name,!0),a(m,i().description||"",!0)):(a(d,""),a(m,"")),a(b,""))});function D(){l(!1),a(b,"")}async function J(v){if(v.preventDefault(),!e(d).trim()){a(b,"Project name is required");return}a(u,!0),a(b,"");try{const p=i()?K(`/projects/${i().id}`):K("/projects"),M=i()?"PATCH":"POST",h=await fetch(p,{method:M,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e(d).trim(),description:e(m).trim()||null})});if(!h.ok){const w=await h.json();throw console.log(w),new Error(w.error||"Failed to save project")}D(),o.onSuccess?.()}catch(p){a(b,p instanceof Error?p.message:"An error occurred",!0)}finally{a(u,!1)}}function q(v){v.target===v.currentTarget&&D()}var c=se(),x=Q(c);{var T=v=>{var p=ze();p.__click=q,p.__keydown=g=>{g.key==="Enter"||g.key};var M=t(p),h=t(M),w=t(h),U=t(w,!0);r(w),r(h);var z=n(h,2),B=t(z);{var L=g=>{var A=Te(),Y=t(A,!0);r(A),V(()=>j(Y,e(b))),E(g,A)};F(B,g=>{e(b)&&g(L)})}var N=n(B,2),k=n(t(N),2);Ce(k),r(N);var C=n(N,2),s=n(t(C),2);Me(s),r(C);var f=n(C,2),y=t(f);y.__click=D;var _=n(y,2),P=t(_,!0);r(_),r(f),r(z),r(M),r(p),V(()=>{j(U,i()?"Edit Project":"Create New Project"),k.disabled=e(u),s.disabled=e(u),y.disabled=e(u),_.disabled=e(u),j(P,e(u)?"Saving...":i()?"Update":"Create")}),Ee("submit",z,J),ue(k,()=>e(d),g=>a(d,g)),ue(s,()=>e(m),g=>a(m,g)),E(v,p)};F(x,v=>{l()&&v(T)})}E(O,c),ne()}ae(["click","keydown"]);var Le=H('<div class="mb-4 rounded-lg bg-red-50 p-3 text-sm text-red-800"> </div>'),He=H('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="0"><div class="w-full max-w-md rounded-lg bg-white shadow-xl"><div class="border-b border-gray-200 px-6 py-4"><h3 id="modal-title" class="text-xl font-bold text-gray-900">Delete Project</h3></div> <div class="p-6"><!> <p class="mb-2 text-gray-700">Are you sure you want to delete <strong> </strong>?</p> <p class="text-sm text-gray-500">This action cannot be undone. This will also delete all associated secrets.</p></div> <div class="flex justify-end gap-3 border-t border-gray-200 px-6 py-4"><button type="button" class="rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button> <button type="button" class="rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700 disabled:bg-red-400"> </button></div></div></div>');function Ne(O,o){oe(o,!0);let l=re(o,"isOpen",15,!1),i=S(!1),d=S("");pe(()=>{l()&&a(d,"")});function m(){l(!1),a(d,"")}async function u(){if(o.project){a(i,!0),a(d,"");try{const c=await fetch(K(`/projects/${o.project.id}`),{method:"DELETE"});if(!c.ok){const x=await c.json();throw new Error(x.message||"Failed to delete project")}m(),o.onSuccess?.()}catch(c){a(d,c instanceof Error?c.message:"An error occurred",!0)}finally{a(i,!1)}}}function b(c){c.target===c.currentTarget&&m()}var D=se(),J=Q(D);{var q=c=>{var x=He();x.__click=b,x.__keydown=k=>{};var T=t(x),v=n(t(T),2),p=t(v);{var M=k=>{var C=Le(),s=t(C,!0);r(C),V(()=>j(s,e(d))),E(k,C)};F(p,k=>{e(d)&&k(M)})}var h=n(p,2),w=n(t(h)),U=t(w,!0);r(w),ve(),r(h),ve(2),r(v);var z=n(v,2),B=t(z);B.__click=m;var L=n(B,2);L.__click=u;var N=t(L,!0);r(L),r(z),r(T),r(x),V(()=>{j(U,o.project.name),B.disabled=e(i),L.disabled=e(i),j(N,e(i)?"Deleting...":"Delete")}),E(c,x)};F(J,c=>{l()&&o.project&&c(q)})}E(O,D),ne()}ae(["click","keydown"]);var Ve=H('<div class="rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 py-12 text-center"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="mt-2 text-lg text-gray-500">No projects yet</p> <p class="mt-1 text-sm text-gray-400">Create your first project to get started</p></div>'),Ae=H('<p class="mt-1 line-clamp-2 text-sm text-gray-600"> </p>'),Fe=H('<div class="group rounded-xl border border-gray-200 bg-white border-r-4 p-6 shadow-sm hover:border-r-blue-400 transition-colors"><div class="flex gap-4"><div class="shrink-0"><div class="flex h-12 w-12 items-center justify-center rounded-lg bg-linear-to-br from-blue-500 to-purple-600 text-white"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg></div></div> <div class="min-w-0 flex-1"><header class="mb-4 flex items-start justify-between gap-4"><div class="min-w-0 flex-1"><h3 class="truncate text-xl font-semibold text-gray-900"> </h3> <!></div> <a class="inline-flex shrink-0 items-center gap-1.5 rounded-md px-3 py-1.5 text-sm font-medium text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-700" title="Open Project"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg> <span>Open Project</span></a></header> <footer class="flex items-center justify-between gap-4 border-t border-gray-100 pt-4"><div class="flex flex-wrap items-center gap-4 text-xs text-gray-500"><span class="flex items-center gap-1.5"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> </span> <span class="flex items-center gap-1.5"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </span></div> <div class="flex shrink-0 gap-2"><button class="flex items-center gap-1.5 rounded-md px-3 py-1.5 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-100 hover:text-gray-900" title="Edit Project"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> <span>Edit</span></button> <button class="flex items-center gap-1.5 rounded-md px-3 py-1.5 text-sm font-medium text-red-600 transition-colors hover:bg-red-50 hover:text-red-700" title="Delete Project"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> <span>Delete</span></button></div></footer></div></div></div>'),Je=H('<div class="flex flex-col gap-4 p-4"><div class="flex items-center justify-between"><h2 class="text-2xl font-bold text-gray-900">Projects</h2> <div class="flex items-center gap-4"><div class="flex items-center gap-2 text-xs"><span></span> <span class="text-gray-600"> </span></div> <button class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700">+ New Project</button></div></div> <!></div> <!> <!>',1);function Ke(O,o){oe(o,!0);let l=S(Pe(o.data.projects||[])),i=S(!1),d=S(!1),m=S(!1),u=S(null);Se(()=>{const s=new EventSource(we("/projects"));return s.onopen=()=>{console.log("Project SSE connected"),a(i,!0)},s.addEventListener("create",f=>{const y=JSON.parse(f.data);a(l,[...e(l),y.data],!0)}),s.addEventListener("update",f=>{const y=JSON.parse(f.data);a(l,e(l).map(_=>_.id===y.data.id?y.data:_),!0)}),s.addEventListener("delete",f=>{const y=JSON.parse(f.data);a(l,e(l).filter(_=>_.id!==y.data.id),!0)}),s.addEventListener("ping",()=>{}),s.onerror=f=>{console.error("Project SSE error:",f),a(i,!1)},()=>{s.close(),a(i,!1)}});function b(s){return new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function D(){a(u,null),a(d,!0)}function J(s){a(u,s,!0),a(d,!0)}function q(s){a(u,s,!0),a(m,!0)}function c(){a(u,null)}var x=Je(),T=Q(x),v=t(T),p=n(t(v),2),M=t(p),h=t(M),w=n(h,2),U=t(w,!0);r(w),r(M);var z=n(M,2);z.__click=D,r(p),r(v);var B=n(v,2);{var L=s=>{var f=Ve();E(s,f)},N=s=>{var f=se(),y=Q(f);je(y,17,()=>e(l),_=>_.id,(_,P)=>{var g=Fe(),A=t(g),Y=n(t(A),2),R=t(Y),Z=t(R),$=t(Z),fe=t($,!0);r($);var ge=n($,2);{var me=G=>{var W=Ae(),_e=t(W,!0);r(W),V(()=>j(_e,e(P).description)),E(G,W)};F(ge,G=>{e(P).description&&G(me)})}r(Z);var be=n(Z,2);r(R);var ie=n(R,2),ee=t(ie),te=t(ee),xe=n(t(te));r(te);var le=n(te,2),he=n(t(le));r(le),r(ee);var de=n(ee,2),ce=t(de);ce.__click=()=>J(e(P));var ye=n(ce,2);ye.__click=()=>q(e(P)),r(de),r(ie),r(Y),r(A),r(g),V((G,W)=>{j(fe,e(P).name),Oe(be,"href",`./projects/${e(P).id}`),j(xe,` ${G??""}`),j(he,` ${W??""}`)},[()=>b(e(P).created_at),()=>b(e(P).updated_at)]),E(_,g)}),E(s,f)};F(B,s=>{e(l).length===0?s(L):s(N,!1)})}r(T);var k=n(T,2);Be(k,{get project(){return e(u)},onSuccess:c,get isOpen(){return e(d)},set isOpen(s){a(d,s,!0)}});var C=n(k,2);Ne(C,{get project(){return e(u)},onSuccess:c,get isOpen(){return e(m)},set isOpen(s){a(m,s,!0)}}),V(()=>{ke(h,1,`h-2 w-2 rounded-full ${e(i)?"bg-green-500":"bg-gray-400"} 
					${e(i)?"animate-pulse":""}`),j(U,e(i)?"Live":"Disconnected")}),E(O,x),ne()}ae(["click"]);export{Ke as component,Ie as universal};
