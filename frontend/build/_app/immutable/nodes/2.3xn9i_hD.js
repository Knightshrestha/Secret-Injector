import{a as K,e as Y,b as le,c as he,s as _e,d as ye}from"../chunks/D9ilNyEn.js";import"../chunks/DsnmJJEf.js";import{d as ee,s as k,e as we,o as je}from"../chunks/D9Q0S_Q0.js";import{p as te,W as ue,G as t,c as re,f as Q,e as E,k as ae,X as S,i as B,l as a,r as o,j as n,o as e,Y as ke,t as A,m as ce,F as Ee}from"../chunks/DjbzThlV.js";import{p as $,i as J}from"../chunks/BPjjjB19.js";import{r as Se,s as Pe}from"../chunks/CkDF1lTp.js";class I extends Error{details;constructor(r,d){super(r),this.details=d}}const Ce=(async({fetch:O})=>{try{const r=await O(K("/projects"));if(!r.ok)throw r.status===404?Y(404,new I("Projects endpoint not found","The server could not find the projects resource")):r.status===401||r.status===403?Y(403):r.status===500?Y(500,new I("Server error","The server encountered an error while fetching projects")):Y(r.status,new I("Failed to fetch projects",`Server returned status ${r.status}: ${r.statusText}`));return{projects:await r.json()}}catch(r){throw r&&typeof r=="object"&&"status"in r?r:(console.error("Error loading projects:",r),Y(503,new I("Failed to connect to server","Please check your network connection and try again")))}}),We=Object.freeze(Object.defineProperty({__proto__:null,load:Ce},Symbol.toStringTag,{value:"Module"}));var Me=B('<div class="mb-4 rounded-lg bg-red-50 p-3 text-sm text-red-800"> </div>'),Oe=B('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4" tabindex="0" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full max-w-md rounded-lg bg-white shadow-xl"><div class="border-b border-gray-200 px-6 py-4"><h3 id="modal-title" class="text-xl font-bold text-gray-900"> </h3></div> <form class="p-6"><!> <div class="mb-4"><label for="name" class="mb-1 block text-sm font-medium text-gray-700">Project Name <span class="text-red-500">*</span></label> <input type="text" id="name" class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none" placeholder="Enter project name" required/></div> <div class="mb-6"><label for="description" class="mb-1 block text-sm font-medium text-gray-700">Description</label> <textarea id="description" rows="3" class="w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none" placeholder="Enter project description (optional)"></textarea></div> <div class="flex justify-end gap-3"><button type="button" class="rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button> <button type="submit" class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:bg-blue-400"> </button></div></form></div></div>');function De(O,r){te(r,!0);let d=$(r,"isOpen",15,!1),i=$(r,"project",3,null),l=S(""),g=S(""),u=S(!1),m=S("");ue(()=>{d()&&(i()?(t(l,i().name,!0),t(g,i().description||"",!0)):(t(l,""),t(g,"")),t(m,""))});function D(){d(!1),t(m,"")}async function H(v){if(v.preventDefault(),!e(l).trim()){t(m,"Project name is required");return}t(u,!0),t(m,"");try{const p=i()?K(`/projects/${i().id}`):K("/projects"),P=i()?"PATCH":"POST",h=await fetch(p,{method:P,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e(l).trim(),description:e(g).trim()||null})});if(!h.ok){const w=await h.json();throw console.log(w),new Error(w.error||"Failed to save project")}D(),r.onSuccess?.()}catch(p){t(m,p instanceof Error?p.message:"An error occurred",!0)}finally{t(u,!1)}}function U(v){v.target===v.currentTarget&&D()}var c=re(),x=Q(c);{var T=v=>{var p=Oe();p.__click=U,p.__keydown=b=>{b.key==="Enter"||b.key};var P=a(p),h=a(P),w=a(h),q=a(w,!0);o(w),o(h);var N=n(h,2),L=a(N);{var z=b=>{var V=Me(),G=a(V,!0);o(V),A(()=>k(G,e(m))),E(b,V)};J(L,b=>{e(m)&&b(z)})}var F=n(L,2),j=n(a(F),2);Se(j),o(F);var M=n(F,2),s=n(a(M),2);ke(s),o(M);var f=n(M,2),_=a(f);_.__click=D;var y=n(_,2),C=a(y,!0);o(y),o(f),o(N),o(P),o(p),A(()=>{k(q,i()?"Edit Project":"Create New Project"),j.disabled=e(u),s.disabled=e(u),_.disabled=e(u),y.disabled=e(u),k(C,e(u)?"Saving...":i()?"Update":"Create")}),we("submit",N,H),le(j,()=>e(l),b=>t(l,b)),le(s,()=>e(g),b=>t(g,b)),E(v,p)};J(x,v=>{d()&&v(T)})}E(O,c),ae()}ee(["click","keydown"]);var Te=B('<div class="mb-4 rounded-lg bg-red-50 p-3 text-sm text-red-800"> </div>'),Ne=B('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="0"><div class="w-full max-w-md rounded-lg bg-white shadow-xl"><div class="border-b border-gray-200 px-6 py-4"><h3 id="modal-title" class="text-xl font-bold text-gray-900">Delete Project</h3></div> <div class="p-6"><!> <p class="mb-2 text-gray-700">Are you sure you want to delete <strong> </strong>?</p> <p class="text-sm text-gray-500">This action cannot be undone. This will also delete all associated secrets.</p></div> <div class="flex justify-end gap-3 border-t border-gray-200 px-6 py-4"><button type="button" class="rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button> <button type="button" class="rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700 disabled:bg-red-400"> </button></div></div></div>');function Le(O,r){te(r,!0);let d=$(r,"isOpen",15,!1),i=S(!1),l=S("");ue(()=>{d()&&t(l,"")});function g(){d(!1),t(l,"")}async function u(){if(r.project){t(i,!0),t(l,"");try{const c=await fetch(K(`/projects/${r.project.id}`),{method:"DELETE"});if(!c.ok){const x=await c.json();throw new Error(x.message||"Failed to delete project")}g(),r.onSuccess?.()}catch(c){t(l,c instanceof Error?c.message:"An error occurred",!0)}finally{t(i,!1)}}}function m(c){c.target===c.currentTarget&&g()}var D=re(),H=Q(D);{var U=c=>{var x=Ne();x.__click=m,x.__keydown=j=>{};var T=a(x),v=n(a(T),2),p=a(v);{var P=j=>{var M=Te(),s=a(M,!0);o(M),A(()=>k(s,e(l))),E(j,M)};J(p,j=>{e(l)&&j(P)})}var h=n(p,2),w=n(a(h)),q=a(w,!0);o(w),ce(),o(h),ce(2),o(v);var N=n(v,2),L=a(N);L.__click=g;var z=n(L,2);z.__click=u;var F=a(z,!0);o(z),o(N),o(T),o(x),A(()=>{k(q,r.project.name),L.disabled=e(i),z.disabled=e(i),k(F,e(i)?"Deleting...":"Delete")}),E(c,x)};J(H,c=>{d()&&r.project&&c(U)})}E(O,D),ae()}ee(["click","keydown"]);var ze=B('<div class="rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 py-12 text-center"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="mt-2 text-lg text-gray-500">No projects yet</p> <p class="mt-1 text-sm text-gray-400">Create your first project to get started</p></div>'),Be=B('<p class="text-sm text-gray-600"> </p>'),Fe=B('<div class="group rounded-xl border border-gray-100 bg-white p-6 shadow-sm transition-all hover:shadow-md"><div class="mb-3 flex items-start justify-between"><div class="flex-1"><h3 class="mb-1 text-xl font-bold text-gray-900"> </h3> <!></div> <div class="flex gap-2 opacity-0 transition-opacity group-hover:opacity-100"><button class="text-sm font-medium text-blue-600 hover:text-blue-800">Edit</button> <button class="text-sm font-medium text-red-600 hover:text-red-800">Delete</button></div></div> <a>Open Project</a> <div class="flex items-center gap-6 border-t border-gray-100 pt-3 text-xs text-gray-500"><span class="flex items-center gap-1"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> </span> <span class="flex items-center gap-1"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </span></div></div>'),Ve=B('<div class="flex flex-col gap-4 p-4"><div class="flex items-center justify-between"><h2 class="text-2xl font-bold text-gray-900">Projects</h2> <div class="flex items-center gap-4"><div class="flex items-center gap-2 text-xs"><span></span> <span class="text-gray-600"> </span></div> <button class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700">+ New Project</button></div></div> <!></div> <!> <!>',1);function Xe(O,r){te(r,!0);let d=S(Ee(r.data.projects||[])),i=S(!1),l=S(!1),g=S(!1),u=S(null);je(()=>{const s=new EventSource(he("/projects"));return s.onopen=()=>{console.log("Project SSE connected"),t(i,!0)},s.addEventListener("create",f=>{const _=JSON.parse(f.data);t(d,[...e(d),_.data],!0)}),s.addEventListener("update",f=>{const _=JSON.parse(f.data);t(d,e(d).map(y=>y.id===_.data.id?_.data:y),!0)}),s.addEventListener("delete",f=>{const _=JSON.parse(f.data);t(d,e(d).filter(y=>y.id!==_.data.id),!0)}),s.addEventListener("ping",()=>{}),s.onerror=f=>{console.error("Project SSE error:",f),t(i,!1)},()=>{s.close(),t(i,!1)}});function m(s){return new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function D(){t(u,null),t(l,!0)}function H(s){t(u,s,!0),t(l,!0)}function U(s){t(u,s,!0),t(g,!0)}function c(){t(u,null)}var x=Ve(),T=Q(x),v=a(T),p=n(a(v),2),P=a(p),h=a(P),w=n(h,2),q=a(w,!0);o(w),o(P);var N=n(P,2);N.__click=D,o(p),o(v);var L=n(v,2);{var z=s=>{var f=ze();E(s,f)},F=s=>{var f=re(),_=Q(f);ye(_,17,()=>e(d),y=>y.id,(y,C)=>{var b=Fe(),V=a(b),G=a(V),R=a(G),ve=a(R,!0);o(R);var pe=n(R,2);{var fe=W=>{var X=Be(),xe=a(X,!0);o(X),A(()=>k(xe,e(C).description)),E(W,X)};J(pe,W=>{e(C).description&&W(fe)})}o(G);var oe=n(G,2),se=a(oe);se.__click=()=>H(e(C));var be=n(se,2);be.__click=()=>U(e(C)),o(oe),o(V);var ne=n(V,2),ie=n(ne,2),Z=a(ie),ge=n(a(Z));o(Z);var de=n(Z,2),me=n(a(de));o(de),o(ie),o(b),A((W,X)=>{k(ve,e(C).name),Pe(ne,"href",`projects/${e(C).id}`),k(ge,` Created ${W??""}`),k(me,` Updated ${X??""}`)},[()=>m(e(C).created_at),()=>m(e(C).updated_at)]),E(y,b)}),E(s,f)};J(L,s=>{e(d).length===0?s(z):s(F,!1)})}o(T);var j=n(T,2);De(j,{get project(){return e(u)},onSuccess:c,get isOpen(){return e(l)},set isOpen(s){t(l,s,!0)}});var M=n(j,2);Le(M,{get project(){return e(u)},onSuccess:c,get isOpen(){return e(g)},set isOpen(s){t(g,s,!0)}}),A(()=>{_e(h,1,`h-2 w-2 rounded-full ${e(i)?"bg-green-500":"bg-gray-400"} 
					${e(i)?"animate-pulse":""}`),k(q,e(i)?"Live":"Disconnected")}),E(O,x),ae()}ee(["click"]);export{Xe as component,We as universal};
